# This file was generated by Chef for <%= node['fqdn'] %>.
# Do not modify this file by hand!
<% ::Chef::Mixin::Template::TemplateContext.send(:include, Nginx::Ssl::StringHelper) %>
server {
  <% if @https %>
  listen  0.0.0.0:443;
  <% parseOptions(node['nginx']['config']['ssl'][@domain]).each do |opt| %>
  <%= opt %>;
  <% end %>
  <% else %>
  listen  0.0.0.0:80;
  <% end %>
  server_name     <%= parseOptions(@servername).map { |opt| opt }.join(" ") %>;
  access_log /var/log/nginx/access-<%= @name%>-.log;
  error_log /var/log/nginx/error-<%= @name%>-.log;
  <% parseOptions(@serveroptions).each do |opt| %>
  <%= opt %>;
  <% end %>


#+++++++++++++++
#++ Modifiers ++
#+++++++++++++++
  <% @modifiers.each do |modname,mod| %>
  # <%= modname %>
  <%=  !mod['type'].nil? ? mod['type'] : 'if' %> (<%= mod['query'] %>){
  <% parseOptions(mod['options']).each do |opt| %>
    <%= opt %>;
  <% end %>
  }
  <% end %>

#+++++++++++++++
#++ Locations ++
#+++++++++++++++
  <% @locations.each do |locname,loc| %>
  # <%= locname %>
  location <%= loc['base'] %> {
  <% parseOptions(loc['options']).each do |opt| %>
    <%= opt %>;
  <% end %>
  }

  <% end %>

}
